#app.rb 

require "sinatra" 
require "sinatra/activerecord"

class ApplicationController < Sinatra::Base
	register Sinatra::ActiveRecordExtension
	configure do
		set :public_folder, 'public'
		set :views, 'app/views'
		enable :sessions
		set :session_secret, "ArmadaUGS"
	end
	get "/" do 
	  @malware = Malware.all
	  erb :index
	end 
	get "/:id" do 
	  @malware = Malware.find_by(id: params["id"])
	  erb :show 
	end   
	get "/:id/edit" do 
		@virus = Malware.find_by(id: params["id"])
		erb :edit
	end 
	post "/:id" do 
		@malware = Malware.find_by(id: params["id"])
		@malware.update(name: params["name"], link: params["link"]) 
		erb :show
	end 
	post "/malwares" do 
		if !params["name"] || !params["link"] 
			@error = "Don't have blank name or link dummy" 
			erb :new 
		else 
			@malware = Malware.create(name: params["name"], link: params["link"], user_id: session["user_id"]) 
			erb :show 
		end 
	end
	get "/malwares/new" do 
		erb :new 
	end 	
end